from office365.sharepoint.client_context import ClientContext
from office365.runtime.auth.user_credential import UserCredential
from office365.runtime.client_request import ClientRequest

# Path to your company's CA certificate file
cert_path = "/path/to/your/company-ca-cert.pem"

# Replace with your SharePoint site URL and credentials
site_url = "https://your-company.sharepoint.com/sites/yoursite"
username = "your-email@your-company.com"
password = "your-password"

# Create the ClientContext with credentials
ctx = ClientContext(site_url).with_credentials(UserCredential(username, password))

# Customize the request session to use the custom SSL certificate
request = ctx._client_request
request.session.verify = cert_path

# Load and execute query
web = ctx.web
ctx.load(web)
ctx.execute_query()
print("Site title: {0}".format(web.properties['Title']))
