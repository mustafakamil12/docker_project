import requests
from requests_ntlm import HttpNtlmAuth

# SharePoint site URL
site_url = "https://your-company.sharepoint.com/sites/your-site"

# Authentication
username = "your-domain\\your-username"
password = "your-password"

# Provide path to your company's internal certificate
cert_path = "/path/to/your/certificate.crt"

# For NTLM Authentication with SSL certificate
session = requests.Session()
session.auth = HttpNtlmAuth(username, password)
session.verify = cert_path  # Or set to False to bypass verification

response = session.get(site_url)
print(response.content)
