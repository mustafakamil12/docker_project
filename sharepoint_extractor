from office365.sharepoint.client_context import ClientContext
from office365.runtime.auth.user_credential import UserCredential

# Replace with your SharePoint site URL and credentials
site_url = "https://your-company.sharepoint.com/sites/yoursite"
username = "your-email@your-company.com"
password = "your-password"

# Authenticate
ctx = ClientContext(site_url).with_credentials(UserCredential(username, password))

# Example: Retrieve the site title
web = ctx.web
ctx.load(web)
ctx.execute_query()
print("Site title: {0}".format(web.properties['Title']))
